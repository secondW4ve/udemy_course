{"ast":null,"code":"var _jsxFileName = \"U:\\\\Java\\\\WaverApp\\\\frontend\\\\src\\\\Components\\\\WaveSubmit.js\";\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport ProfileImage from './ProfileImage';\nimport * as apiCalls from '../api/apiCalls';\nimport ButtonWithProgress from './ButtonWithProgress';\nimport Input from './Input';\n\nclass WaveSubmit extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      focused: false,\n      content: undefined,\n      pendingApiCall: false,\n      errors: {},\n      file: undefined,\n      image: undefined,\n      attachment: undefined\n    };\n\n    this.onFocus = () => {\n      this.setState({\n        focused: true\n      });\n    };\n\n    this.onChangeContent = event => {\n      const value = event.target.value;\n      this.setState({\n        content: value,\n        errors: {}\n      });\n    };\n\n    this.resetState = () => {\n      this.setState({\n        pendingApiCall: false,\n        focused: false,\n        content: '',\n        errors: {},\n        image: undefined,\n        file: undefined\n      });\n    };\n\n    this.onClickRunWave = () => {\n      const body = {\n        content: this.state.content,\n        attachment: this.state.attachment\n      };\n      this.setState({\n        pendingApiCall: true\n      });\n      apiCalls.postWave(body).then(response => {\n        this.resetState();\n      }).catch(error => {\n        let errors = {};\n\n        if (error.response.data && error.response.data.validationErrors) {\n          errors = error.response.data.validationErrors;\n        }\n\n        this.setState({\n          pendingApiCall: false,\n          errors\n        });\n      });\n    };\n\n    this.onFileSelect = event => {\n      if (event.target.files.length === 0) {\n        return;\n      }\n\n      const errors = { ...this.state.errors\n      };\n      errors.image = undefined;\n      const file = event.target.files[0];\n      let reader = new FileReader();\n\n      reader.onloadend = () => {\n        this.setState({\n          image: reader.result,\n          file\n        }, () => {\n          this.uploadFile();\n        });\n      };\n\n      reader.readAsDataURL(file);\n    };\n\n    this.uploadFile = () => {\n      const body = new FormData();\n      body.append('file', this.state.file);\n      apiCalls.postWaveFile(body).then(response => {\n        this.setState({\n          attachment: response.data\n        });\n      });\n    };\n  }\n\n  render() {\n    let textAreaClassName = \"form-control w-100\";\n\n    if (this.state.errors.content) {\n      textAreaClassName += \" is-invalid\";\n    }\n\n    return React.createElement(\"div\", {\n      className: \"card d-flex flex-row p-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(ProfileImage, {\n      className: \"rounded-circle m-1\",\n      width: \"32\",\n      height: \"32\",\n      image: this.props.loggedInUser.image,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"flex-fill\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, React.createElement(\"textarea\", {\n      className: textAreaClassName,\n      rows: this.state.focused ? 3 : 1,\n      onFocus: this.onFocus,\n      value: this.state.content,\n      onChange: this.onChangeContent,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }), this.state.errors.content && React.createElement(\"span\", {\n      className: \"invalid-feedback\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, this.state.errors.content), this.state.focused && React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"pt-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    }, React.createElement(Input, {\n      type: \"file\",\n      onChange: this.onFileSelect,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }), this.state.image && React.createElement(\"img\", {\n      className: \"mt-1 img-thumbnail\",\n      src: this.state.image,\n      alt: \"upload\",\n      width: \"128\",\n      height: \"64\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"text-right mt-1\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, React.createElement(ButtonWithProgress, {\n      className: \"btn btn-success\",\n      onClick: this.onClickRunWave,\n      disabled: this.state.pendingApiCall,\n      pendingApiCall: this.state.pendingApiCall,\n      text: \"Run wave\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"btn btn-light ml-1\",\n      onClick: this.resetState,\n      disabled: this.state.pendingApiCall,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, \"Extinguish wave\")))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state\n  };\n};\n\nexport default connect(mapStateToProps)(WaveSubmit);","map":{"version":3,"sources":["U:/Java/WaverApp/frontend/src/Components/WaveSubmit.js"],"names":["React","Component","connect","ProfileImage","apiCalls","ButtonWithProgress","Input","WaveSubmit","state","focused","content","undefined","pendingApiCall","errors","file","image","attachment","onFocus","setState","onChangeContent","event","value","target","resetState","onClickRunWave","body","postWave","then","response","catch","error","data","validationErrors","onFileSelect","files","length","reader","FileReader","onloadend","result","uploadFile","readAsDataURL","FormData","append","postWaveFile","render","textAreaClassName","props","loggedInUser","mapStateToProps"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,OAAOC,YAAP,MAAyB,gBAAzB;AACA,OAAO,KAAKC,QAAZ,MAA0B,iBAA1B;AACA,OAAOC,kBAAP,MAA+B,sBAA/B;AACA,OAAOC,KAAP,MAAkB,SAAlB;;AAEA,MAAMC,UAAN,SAAyBN,SAAzB,CAAmC;AAAA;AAAA;AAAA,SAE/BO,KAF+B,GAEvB;AACJC,MAAAA,OAAO,EAAE,KADL;AAEJC,MAAAA,OAAO,EAAEC,SAFL;AAGJC,MAAAA,cAAc,EAAE,KAHZ;AAIJC,MAAAA,MAAM,EAAE,EAJJ;AAKJC,MAAAA,IAAI,EAAEH,SALF;AAMJI,MAAAA,KAAK,EAAEJ,SANH;AAOJK,MAAAA,UAAU,EAAEL;AAPR,KAFuB;;AAAA,SAY/BM,OAZ+B,GAYrB,MAAM;AACZ,WAAKC,QAAL,CAAc;AAACT,QAAAA,OAAO,EAAE;AAAV,OAAd;AACH,KAd8B;;AAAA,SAgB/BU,eAhB+B,GAgBZC,KAAD,IAAW;AACzB,YAAMC,KAAK,GAAGD,KAAK,CAACE,MAAN,CAAaD,KAA3B;AACA,WAAKH,QAAL,CAAc;AAACR,QAAAA,OAAO,EAAEW,KAAV;AAAiBR,QAAAA,MAAM,EAAE;AAAzB,OAAd;AACH,KAnB8B;;AAAA,SAqB/BU,UArB+B,GAqBlB,MAAM;AACf,WAAKL,QAAL,CAAc;AACVN,QAAAA,cAAc,EAAE,KADN;AAEVH,QAAAA,OAAO,EAAE,KAFC;AAGVC,QAAAA,OAAO,EAAE,EAHC;AAIVG,QAAAA,MAAM,EAAE,EAJE;AAKVE,QAAAA,KAAK,EAAEJ,SALG;AAMVG,QAAAA,IAAI,EAAEH;AANI,OAAd;AAQH,KA9B8B;;AAAA,SAgC/Ba,cAhC+B,GAgCd,MAAM;AACnB,YAAMC,IAAI,GAAG;AACTf,QAAAA,OAAO,EAAE,KAAKF,KAAL,CAAWE,OADX;AAETM,QAAAA,UAAU,EAAE,KAAKR,KAAL,CAAWQ;AAFd,OAAb;AAIA,WAAKE,QAAL,CAAc;AAACN,QAAAA,cAAc,EAAE;AAAjB,OAAd;AACAR,MAAAA,QAAQ,CAACsB,QAAT,CAAkBD,IAAlB,EACKE,IADL,CACWC,QAAD,IAAc;AAChB,aAAKL,UAAL;AACH,OAHL,EAIKM,KAJL,CAIYC,KAAD,IAAW;AACd,YAAIjB,MAAM,GAAG,EAAb;;AACA,YAAIiB,KAAK,CAACF,QAAN,CAAeG,IAAf,IAAuBD,KAAK,CAACF,QAAN,CAAeG,IAAf,CAAoBC,gBAA/C,EAAgE;AAC5DnB,UAAAA,MAAM,GAAGiB,KAAK,CAACF,QAAN,CAAeG,IAAf,CAAoBC,gBAA7B;AACH;;AACD,aAAKd,QAAL,CAAc;AACVN,UAAAA,cAAc,EAAE,KADN;AAEVC,UAAAA;AAFU,SAAd;AAIH,OAbL;AAcH,KApD8B;;AAAA,SAsD/BoB,YAtD+B,GAsDfb,KAAD,IAAW;AACtB,UAAIA,KAAK,CAACE,MAAN,CAAaY,KAAb,CAAmBC,MAAnB,KAA8B,CAAlC,EAAoC;AAChC;AACH;;AACD,YAAMtB,MAAM,GAAG,EAAC,GAAG,KAAKL,KAAL,CAAWK;AAAf,OAAf;AACAA,MAAAA,MAAM,CAACE,KAAP,GAAeJ,SAAf;AACA,YAAMG,IAAI,GAAGM,KAAK,CAACE,MAAN,CAAaY,KAAb,CAAmB,CAAnB,CAAb;AACA,UAAIE,MAAM,GAAG,IAAIC,UAAJ,EAAb;;AACAD,MAAAA,MAAM,CAACE,SAAP,GAAmB,MAAM;AACrB,aAAKpB,QAAL,CAAc;AACVH,UAAAA,KAAK,EAAEqB,MAAM,CAACG,MADJ;AAEVzB,UAAAA;AAFU,SAAd,EAGG,MAAM;AACL,eAAK0B,UAAL;AACH,SALD;AAMH,OAPD;;AAQAJ,MAAAA,MAAM,CAACK,aAAP,CAAqB3B,IAArB;AACH,KAvE8B;;AAAA,SAyE/B0B,UAzE+B,GAyElB,MAAM;AACf,YAAMf,IAAI,GAAG,IAAIiB,QAAJ,EAAb;AACAjB,MAAAA,IAAI,CAACkB,MAAL,CAAY,MAAZ,EAAoB,KAAKnC,KAAL,CAAWM,IAA/B;AACAV,MAAAA,QAAQ,CAACwC,YAAT,CAAsBnB,IAAtB,EACKE,IADL,CACUC,QAAQ,IAAI;AACd,aAAKV,QAAL,CAAc;AAACF,UAAAA,UAAU,EAAEY,QAAQ,CAACG;AAAtB,SAAd;AACH,OAHL;AAIH,KAhF8B;AAAA;;AAkF/Bc,EAAAA,MAAM,GAAG;AACL,QAAIC,iBAAiB,GAAG,oBAAxB;;AACA,QAAI,KAAKtC,KAAL,CAAWK,MAAX,CAAkBH,OAAtB,EAA8B;AAC1BoC,MAAAA,iBAAiB,IAAI,aAArB;AACH;;AACD,WACI;AAAK,MAAA,SAAS,EAAG,0BAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,YAAD;AACI,MAAA,SAAS,EAAG,oBADhB;AAEI,MAAA,KAAK,EAAG,IAFZ;AAGI,MAAA,MAAM,EAAG,IAHb;AAII,MAAA,KAAK,EAAI,KAAKC,KAAL,CAAWC,YAAX,CAAwBjC,KAJrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAOI;AAAK,MAAA,SAAS,EAAG,WAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AACI,MAAA,SAAS,EAAI+B,iBADjB;AAEI,MAAA,IAAI,EAAI,KAAKtC,KAAL,CAAWC,OAAX,GAAqB,CAArB,GAAyB,CAFrC;AAGI,MAAA,OAAO,EAAI,KAAKQ,OAHpB;AAII,MAAA,KAAK,EAAI,KAAKT,KAAL,CAAWE,OAJxB;AAKI,MAAA,QAAQ,EAAI,KAAKS,eALrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAQK,KAAKX,KAAL,CAAWK,MAAX,CAAkBH,OAAlB,IAA8B;AAAM,MAAA,SAAS,EAAG,kBAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAsC,KAAKF,KAAL,CAAWK,MAAX,CAAkBH,OAAxD,CARnC,EASK,KAAKF,KAAL,CAAWC,OAAX,IACG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AACI,MAAA,SAAS,EAAC,MADd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAGI,oBAAC,KAAD;AACI,MAAA,IAAI,EAAG,MADX;AAEI,MAAA,QAAQ,EAAE,KAAKwB,YAFnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHJ,EAOK,KAAKzB,KAAL,CAAWO,KAAX,IACD;AACI,MAAA,SAAS,EAAC,oBADd;AAEI,MAAA,GAAG,EAAI,KAAKP,KAAL,CAAWO,KAFtB;AAGI,MAAA,GAAG,EAAC,QAHR;AAII,MAAA,KAAK,EAAC,KAJV;AAKI,MAAA,MAAM,EAAC,IALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MARJ,CADJ,EAiBI;AAAK,MAAA,SAAS,EAAG,iBAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,kBAAD;AACI,MAAA,SAAS,EAAG,iBADhB;AAEI,MAAA,OAAO,EAAI,KAAKS,cAFpB;AAGI,MAAA,QAAQ,EAAI,KAAKhB,KAAL,CAAWI,cAH3B;AAII,MAAA,cAAc,EAAI,KAAKJ,KAAL,CAAWI,cAJjC;AAKI,MAAA,IAAI,EAAG,UALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EASI;AACI,MAAA,SAAS,EAAG,oBADhB;AAEI,MAAA,OAAO,EAAI,KAAKW,UAFpB;AAGI,MAAA,QAAQ,EAAI,KAAKf,KAAL,CAAWI,cAH3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBATJ,CAjBJ,CAVR,CAPJ,CADJ;AA0DH;;AAjJ8B;;AAoJnC,MAAMqC,eAAe,GAAIzC,KAAD,IAAW;AAC/B,SAAO;AACHwC,IAAAA,YAAY,EAAExC;AADX,GAAP;AAGH,CAJD;;AAMA,eAAeN,OAAO,CAAC+C,eAAD,CAAP,CAAyB1C,UAAzB,CAAf","sourcesContent":["import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\nimport ProfileImage from './ProfileImage';\r\nimport * as apiCalls from '../api/apiCalls';\r\nimport ButtonWithProgress from './ButtonWithProgress';\r\nimport Input from './Input';\r\n\r\nclass WaveSubmit extends Component {\r\n\r\n    state = {\r\n        focused: false,\r\n        content: undefined,\r\n        pendingApiCall: false,\r\n        errors: {},\r\n        file: undefined,\r\n        image: undefined,\r\n        attachment: undefined,\r\n    }\r\n\r\n    onFocus = () => {\r\n        this.setState({focused: true});\r\n    }\r\n\r\n    onChangeContent = (event) => {\r\n        const value = event.target.value;\r\n        this.setState({content: value, errors: {}});\r\n    }\r\n\r\n    resetState = () => {\r\n        this.setState({\r\n            pendingApiCall: false,\r\n            focused: false,\r\n            content: '',\r\n            errors: {},\r\n            image: undefined,\r\n            file: undefined,\r\n        })\r\n    }\r\n\r\n    onClickRunWave = () => {\r\n        const body = {\r\n            content: this.state.content,\r\n            attachment: this.state.attachment,\r\n        };\r\n        this.setState({pendingApiCall: true});\r\n        apiCalls.postWave(body)\r\n            .then((response) => {\r\n                this.resetState();\r\n            })\r\n            .catch((error) => {\r\n                let errors = {}\r\n                if (error.response.data && error.response.data.validationErrors){\r\n                    errors = error.response.data.validationErrors;\r\n                }\r\n                this.setState({\r\n                    pendingApiCall: false,\r\n                    errors,\r\n                });\r\n            });\r\n    }\r\n\r\n    onFileSelect = (event) => {\r\n        if (event.target.files.length === 0){\r\n            return;\r\n        }\r\n        const errors = {...this.state.errors};\r\n        errors.image = undefined;\r\n        const file = event.target.files[0];\r\n        let reader = new FileReader();\r\n        reader.onloadend = () => {\r\n            this.setState({\r\n                image: reader.result,\r\n                file\r\n            }, () => {\r\n                this.uploadFile()\r\n            })\r\n        }\r\n        reader.readAsDataURL(file);\r\n    }\r\n\r\n    uploadFile = () => {\r\n        const body = new FormData();\r\n        body.append('file', this.state.file);\r\n        apiCalls.postWaveFile(body)\r\n            .then(response => {\r\n                this.setState({attachment: response.data})\r\n            });\r\n    }\r\n\r\n    render() {\r\n        let textAreaClassName = \"form-control w-100\";\r\n        if (this.state.errors.content){\r\n            textAreaClassName += \" is-invalid\"\r\n        }\r\n        return (\r\n            <div className = \"card d-flex flex-row p-1\">\r\n                <ProfileImage\r\n                    className = \"rounded-circle m-1\"\r\n                    width = \"32\"\r\n                    height = \"32\"\r\n                    image = {this.props.loggedInUser.image}\r\n                />\r\n                <div className = \"flex-fill\">\r\n                    <textarea \r\n                        className = {textAreaClassName} \r\n                        rows = {this.state.focused ? 3 : 1}\r\n                        onFocus = {this.onFocus}\r\n                        value = {this.state.content}\r\n                        onChange = {this.onChangeContent}\r\n                    /> \r\n                    {this.state.errors.content && (<span className = \"invalid-feedback\">{this.state.errors.content}</span>)}\r\n                    {this.state.focused && (\r\n                        <div>\r\n                            <div \r\n                                className=\"pt-1\"\r\n                            >\r\n                                <Input\r\n                                    type = \"file\"\r\n                                    onChange={this.onFileSelect}\r\n                                />\r\n                                {this.state.image && \r\n                                <img \r\n                                    className=\"mt-1 img-thumbnail\" \r\n                                    src = {this.state.image} \r\n                                    alt=\"upload\" \r\n                                    width=\"128\"\r\n                                    height=\"64\"\r\n                                />}    \r\n                            </div>\r\n                            <div className = \"text-right mt-1\">\r\n                                <ButtonWithProgress \r\n                                    className = \"btn btn-success\"\r\n                                    onClick = {this.onClickRunWave}    \r\n                                    disabled = {this.state.pendingApiCall}\r\n                                    pendingApiCall = {this.state.pendingApiCall}\r\n                                    text = \"Run wave\"\r\n                                >\r\n                                </ButtonWithProgress>  \r\n                                <button \r\n                                    className = \"btn btn-light ml-1\" \r\n                                    onClick = {this.resetState}\r\n                                    disabled = {this.state.pendingApiCall}\r\n                                >\r\n                                    Extinguish wave\r\n                                </button>\r\n                            </div>  \r\n                        </div>\r\n                    )}\r\n                    \r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        loggedInUser: state\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps)(WaveSubmit);"]},"metadata":{},"sourceType":"module"}